<!DOCTYPE html>
<html lang="en">
<head>

    <meta name="theme-color" content="#1B5E20">

    <base href="/">
    <meta charset="UTF-8">
    <title>Online Code Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.2/socket.io.js"></script>
    <script src="./public/js/socket-editor.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/search/search.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/search/searchcursor.min.js"></script>
    <script src="./public/js/codemirror/addon/search/jump-to-line.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/search/match-highlighter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/search/matchesonscrollbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/dialog/dialog.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/scroll/annotatescrollbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/selection/active-line.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/hint/anyword-hint.min.js"></script>
    <script src="./public/js/clipboard.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/search/matchesonscrollbar.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/dialog/dialog.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.26.0/addon/hint/show-hint.min.css">
    <link rel="stylesheet" href="./public/css/index.css">
</head>
<body class="green lighten-5" ng-app="codeEditorApp">
<nav class="green darken-4" role="navigation">
    <div class="nav-wrapper">
        <a href="/" class="brand-logo center">CodeEditorInc$$</a>
        <ul class="right hide-on-med-and-down">
            <li><a href="#modal1" id="settings">Settings</a></li>
        </ul>
    </div>
</nav>

<script type="application/javascript">
    $(".dropdown-button").dropdown();
</script>
<main>
    <div>

        <textarea id="codemirror"></textarea>

    </div>
    <div class="fixed-action-btn horizontal" style="bottom: 24px; right: 24px;">
        <a id="share" class="btn-floating green darken-4 btn-large tooltipped" data-position="top" data-delay="50" data-tooltip="Copy link to clipboard">
        	<i class="large material-icons">assignment</i>
        </a>

        <a id="download" class="btn-floating green darken-4 btn-large tooltipped" data-position="top" data-delay="50" data-tooltip="Download">
            <i class="large material-icons">file_download</i>
        </a>
    </div>

    <div id="modal1" class="modal">
        <div class="modal-content">
            <h4>Editor settings</h4>

            <div class="col s6">
                <select id="languageSelect">
                    <option value="" disabled selected>Choose your language</option>
                    <option value="php">Php</option>
                    <option value="javascript">Javascript</option>
                    <option value="haskell">Haskell</option>
                </select>
                <label>Programming language</label>
            </div>

            <div class="col s6">
                <select id="themeSelect">
                    <option value="" disabled selected>Choose your theme</option>
                    <option value="3024-day">3024-day</option>
                    <option value="3024-night">3024-night</option>
                    <option value="abcdef">abcdef</option>
                    <option value="ambiance-mobile">ambiance-mobile</option>
                    <option value="ambiance">ambiance</option>
                    <option value="base16-dark">base16-dark</option>
                    <option value="base16-light">base16-light</option>
                    <option value="bespin">bespin</option>
                    <option value="blackboard">blackboard</option>
                    <option value="cobalt">cobalt</option>
                    <option value="colorforth">colorforth</option>
                    <option value="dracula">dracula</option>
                    <option value="eclipse">eclipse</option>
                    <option value="elegant">elegant</option>
                    <option value="erlang-dark">erlang-dark</option>
                    <option value="hopscotch">hopscotch</option>
                    <option value="icecoder">icecoder</option>
                    <option value="isotope">isotope</option>
                    <option value="lesser-dark">lesser-dark</option>
                    <option value="liquibyte">liquibyte</option>
                    <option value="material">material</option>
                    <option value="mbo">mbo</option>
                    <option value="mdn-like">mdn-like</option>
                    <option value="midnight">midnight</option>
                    <option value="monokai">monokai</option>
                    <option value="neat">neat</option>
                    <option value="neo">neo</option>
                    <option value="night">night</option>
                    <option value="paraiso-dark">paraiso-dark</option>
                    <option value="paraiso-light">paraiso-light</option>
                    <option value="pastel-on-dark">pastel-on-dark</option>
                    <option value="railscasts">railscasts</option>
                    <option value="rubyblue">rubyblue</option>
                    <option value="seti">seti</option>
                    <option value="solarized">solarized</option>
                    <option value="the-matrix">the-matrix</option>
                    <option value="tomorrow-night-bright">tomorrow-night-bright</option>
                    <option value="tomorrow-night-eighties">tomorrow-night-eighties</option>
                    <option value="ttcn">ttcn</option>
                    <option value="twilight">twilight</option>
                    <option value="vibrant-ink">vibrant-ink</option>
                    <option value="xq-dark">xq-dark</option>
                    <option value="xq-light">xq-light</option>
                    <option value="yeti">yeti</option>
                    <option value="zenburn">zenburn</option>
                </select>
                <label>Editor Themes</label>
            </div>

            <div class="col s6">
                <select id="keymapSelect">
                    <option value="" disabled selected>Choose your preferred keymap</option>
                    <option value="emacs">emacs</option>
                    <option value="sublime">sublime</option>
                    <option value="vim">vim</option>
                </select>
                <label>KeyMap</label>
            </div>

        </div>

        <div class="modal-footer">
            <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat" id="modal-close">Ok</a>
        </div>

        <script>
			$('#modal-close').on('click', function (e) {
				e.preventDefault();
				$('#modal1').closeModal();
			});
		</script>

    </div>

    <script>

        $(document).ready(function () {

            $('#languageSelect').material_select();
            $('#themeSelect').material_select();
            $('#keymapSelect').material_select();


            $('#settings').on('click', function (event) {

                event.preventDefault();
                $('#modal1').openModal();

            });

			$('#share').attr('data-clipboard-text', window.location);


			//counts visits so that it knows when to display tips
			var visits = localStorage.getItem('visits');
			if(visits == null){
				visits = 1;
			} else {
				visits++;
			}
			localStorage.setItem('visits', visits);

			if(visits < 3){
				Materialize.toast('Press the button below to copy link and share your code with others', 5000);
			}

			var clipboard = new Clipboard('#share');

			clipboard.on('success', function(e) {
				Materialize.toast('Link copied to clipboard', 4000);
				if(visits < 3){
					setTimeout(function(){
						Materialize.toast('Anyone with the link can see what you are typing', 4000);
					}, 4000);
				}
			});
			clipboard.on('error', function(e) {
				window.prompt("Copy this text and press Enter", window.location);
			});
        });

    </script>

</main>


</body>
</html>
